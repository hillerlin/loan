function countDown(t){$.ajax({url:"/index/send-sms-code",data:{mobile:mobile,srvTxCode:"accountOpenPlus"},type:"post",dataType:"JSON",success:function(){if(t){var e=format(mobile);$(".foot .prompt").text(""),$(".message span").text(e),$(".mask").show()}var o=60;$(".code_status").text("60s").removeClass("status_color");var a=setInterval(function(){o>0?$(".code_status").text(--o+"s"):(clearInterval(a),$(".code_status").text("重发").addClass("status_color"))},1e3);flagCode=!0},error:function(e){t?$(".foot .prompt").text("信息校验有误，请重新验证"):$(".mask .prompt").text(e.retMsg),flagCode=!0}})}function format(t){var e=/^(\d{3})\d{4}(\d{4})$/;return t=t.replace(e,"$1****$2")}var flagNext=!0,flagCode=!0,mobile;$(function(){$(".foot .next").on("click",function(){if(!flagNext)return!1;var t=$("input[name='dmId']").val(),e=$(".realname").val(),o=$(".idNo").val(),a=$(".cardNo").val(),n=/[\u4e00-\u9fa5]/gm,d=/^(^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$)|(^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$)$/,s=/^([1-9]{1})(\d{14}|\d{18})$/;n.test(e)&&d.test(o)&&s.test(a)?(flagNext=!1,$.ajax({url:"/index/check-user-info",type:"post",data:{dmId:t,realName:e,idNo:o+"",cardNo:a},dataType:"JSON",success:function(t){if(0==t.retCode){var e=t.retData;mobile=e.mobile,$("input[name='cardNo']").val(a),countDown(!0)}else $(".foot .prompt").text("信息校验有误，请重新验证");flagNext=!0},error:function(){flagNext=!0,$(".foot .prompt").text("信息校验有误，请重新验证")}})):$(".foot .prompt").text("信息校验有误，请重新验证")}),$(".mask .code_status").on("click",function(){if("重发"==$(this).text()){if(!flagCode)return!1;flagCode=!1,countDown(!1)}}),$(".check .btn").on("click",function(t){var e=($("inout[name='dmId']").val(),$(".cardNo").val()),o=$(".smscode").val(),a=/^\d{6}$/;$("input[name='cardNo']").val(e),$("input[name='smsCode']").val(o),a.test(o)||($(".mask .prompt").text("请重新输入验证码"),t.preventDefault())})});